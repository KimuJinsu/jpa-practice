# JPA (Java Persistence API)

## 📘 소개

**JPA (Java Persistence API)**는 자바 애플리케이션에서 데이터베이스와 상호작용할 수 있는 표준 API입니다. JPA는 자바 객체와 관계형 데이터베이스 간의 **객체-관계 매핑(ORM)**을 지원해, 데이터베이스와 객체 간의 데이터를 쉽게 저장하고 조회할 수 있게 해줍니다. 이를 통해 복잡한 SQL 쿼리를 작성할 필요 없이 객체지향적으로 데이터베이스 작업을 처리할 수 있습니다.

---

## 🚀 주요 개념

### 1. **Entity**

`Entity`는 데이터베이스 테이블에 매핑되는 자바 클래스입니다. 엔티티는 주로 비즈니스 도메인의 객체를 표현하며, 엔티티 클래스의 인스턴스는 데이터베이스의 각 행(row)에 해당합니다. JPA에서 엔티티 클래스는 `@Entity` 어노테이션을 통해 정의됩니다. 엔티티는 영속성 컨텍스트에서 관리되며, 이 상태에서 데이터베이스와 동기화됩니다.

---

### 2. **Primary Key**

모든 엔티티는 **Primary Key(기본 키)**를 통해 고유하게 식별됩니다. 기본 키는 데이터베이스 테이블에서 행을 식별하는 데 사용되며, 엔티티 클래스에서 `@Id` 어노테이션을 사용하여 정의됩니다. 기본 키는 수동으로 설정할 수도 있지만, JPA는 `@GeneratedValue` 어노테이션을 통해 자동으로 기본 키를 생성하는 방법도 제공합니다.

---

### 3. **EntityManager**

`EntityManager`는 JPA에서 가장 중요한 객체 중 하나로, 엔티티를 관리하고 데이터베이스와의 상호작용을 담당합니다. 엔티티의 생명주기(삽입, 수정, 삭제 등)를 제어하고, 트랜잭션을 처리하며, 데이터베이스와의 통신을 수행합니다. `EntityManager`는 JPA의 **영속성 컨텍스트(Persistence Context)**를 사용하여 엔티티를 관리하는데, 영속성 컨텍스트는 엔티티 객체들을 메모리상에서 관리하는 공간입니다.

---

### 4. **영속성 컨텍스트 (Persistence Context)**

**영속성 컨텍스트**는 JPA의 핵심 개념 중 하나로, 엔티티 객체를 메모리 상에서 관리하는 공간입니다. 영속성 컨텍스트는 데이터베이스와의 **싱크(동기화)**를 유지하며, 엔티티 객체의 변경 사항이 자동으로 데이터베이스에 반영되도록 합니다. 이 컨텍스트에서 관리되는 엔티티는 **영속 상태(Persistent State)**에 있다고 하며, 변경된 데이터는 트랜잭션이 커밋될 때 데이터베이스에 반영됩니다.

---

### 5. **영속 상태 (Persistent State), 비영속 상태 (Transient State), 준영속 상태 (Detached State)**

- **영속 상태**: 엔티티가 영속성 컨텍스트에 의해 관리되고 있을 때, 이를 **영속 상태**라고 합니다. 영속 상태의 엔티티는 데이터베이스와 동기화됩니다.
- **비영속 상태**: 엔티티 객체가 생성되었지만 아직 영속성 컨텍스트에 저장되지 않은 상태를 말합니다. 이 상태에서는 데이터베이스와의 연결이 없습니다.
- **준영속 상태**: 한때 영속 상태였으나, 영속성 컨텍스트에서 분리된 엔티티를 **준영속 상태**라고 합니다. 이 상태의 엔티티는 더 이상 데이터베이스와 동기화되지 않습니다.

---

### 6. **JPQL (Java Persistence Query Language)**

**JPQL**은 JPA에서 사용하는 쿼리 언어로, SQL과 비슷하지만 객체와 필드를 기준으로 데이터베이스를 조회할 수 있습니다. JPQL은 데이터베이스의 테이블을 직접적으로 조회하는 것이 아니라, **엔티티 객체**를 대상으로 조회합니다. 이를 통해 객체 지향적인 방식으로 데이터베이스 쿼리를 작성할 수 있습니다.

---

### 7. **트랜잭션 관리**

JPA는 데이터베이스와의 모든 상호작용이 **트랜잭션** 내에서 일어나도록 요구합니다. 트랜잭션은 데이터의 일관성을 보장하기 위해 여러 데이터베이스 작업을 하나의 단위로 묶어 처리하는 방식입니다. **EntityManager**는 트랜잭션을 관리하며, 모든 데이터 변경 작업(삽입, 수정, 삭제)은 트랜잭션 내에서 실행됩니다. 트랜잭션이 커밋되면 데이터베이스에 변경 사항이 반영되고, 롤백하면 변경 사항이 취소됩니다.

---

### 8. **관계 매핑 (Relationship Mapping)**

JPA는 객체 간의 관계를 데이터베이스 테이블 간의 **외래 키(Foreign Key)** 관계로 매핑할 수 있습니다. 주로 다음과 같은 관계를 지원합니다:

- **일대일 (One-to-One)**: 두 엔티티 간의 1:1 관계를 매핑합니다.
- **일대다 (One-to-Many)**: 하나의 엔티티가 여러 엔티티와 관계를 맺습니다.
- **다대일 (Many-to-One)**: 여러 엔티티가 하나의 엔티티와 관계를 맺습니다.
- **다대다 (Many-to-Many)**: 여러 엔티티가 서로 다수의 관계를 맺습니다.

이 관계들은 `@OneToOne`, `@OneToMany`, `@ManyToOne`, `@ManyToMany` 어노테이션을 사용해 매핑됩니다.

---

## 🔗 JPA의 이점

- **객체 지향적인 데이터베이스 접근**: SQL 대신 자바 객체로 데이터베이스를 조작할 수 있습니다.
- **자동화된 데이터베이스 관리**: 테이블 생성, 관계 매핑, 데이터베이스 변경 사항 등을 자동으로 처리할 수 있습니다.
- **데이터베이스 독립성**: JPA는 특정 데이터베이스에 종속되지 않으므로, 애플리케이션을 다양한 데이터베이스에 쉽게 이식할 수 있습니다.
- **생산성 향상**: 직접적인 SQL 작성이 필요 없어 개발 시간이 단축되고 유지보수 비용이 절감됩니다.
